---
title: "[WiP] Practical Malware Analysis - Labs Writeup - Lab 1"
date: 2024-03-15T09:48:30-04:00
categories:
  - blog
  - malwareanalysis
  - reverseengineering
tags:
  - malwareanalysis
  - reverseengineering
  - practicalmalwareanalysis
---
In this blog posts series, I'll be delving into the practical exercises provided in the renowned book "Practical Malware Analysis," offering insights, strategies, and hands-on experiences to fortify my understanding of malware behavior and analysis techniques. 

I will also try out more modern tools and prepare things like Yara rules and more extensive reportes whenever possible, in order to use every opportunity to sharpen all those essential and additional skills.

![pma](/assets/images/81wIATT3RRL._AC_UF1000,1000_QL80_.jpg)

# Chapter 1 
## Lab 1-1: 
### Question 1: Upload the files to http://www.VirusTotal.com/ and view the reports. Does either file match any existing antivirus signatures?


Lab01-01.exe
![pma](/assets/images/Lab01-01exe.png)

Lab01-01.dll
![pma](/assets/images/Lab01-01dll.png)


### Question 2: When were these files compiled?

Lab01-01.exe

Sun Dec 19 16:16:19 2010 | UTC

Lab01-01.dll

Sun Dec 19 16:16:38 2010 | UTC

### Question 3: Are there any indications that either of these files is packed or obfuscated? If so, what are these indicators?
<!--TODO: Note on PE Entropy-->
Lab01-01.exe

![entropy1-1exe](/assets/images/Entropy1-1exe.png)
![bintext1-1exe](/assets/images/bintext1-1exe.png)

Lab01-01.dll

![entropy1-1dll](/assets/images/Entropy1-1dll.png)
![bintext1-1dll](/assets/images/bintext1-1dll.png)


For both samples calculated entropy is in the mid range, PEiD didn't detect any packer used, but was able to detect most likely used compiler. BinText we are able to see readable strings. So there are no indicators that those binaries were packed.

### Question 4: Do any imports hint at what this malware does? If so, which imports are they?

For Lab01-01.exe there are a couple of imports that attract attention:
-KERNEL32.dll
&emsp;→ CopyFileA/CreateFileA/CreateFileMappingA
  
&emsp;→ FindClose/FindFirstFileA/FindNextFileA
  
&emsp;→ IsBadReadPtr
  
&emsp;→ MapViewOfFile/UnmapViewOfFile

Potentialy the file create some files. Potential dropper (?) 

### Question 5: Are there any other files or host-based indicators that you could look for on infected systems?

### Question 6: What network-based indicators could be used to find this malware on infected machines?

### Question 7: What would you guess is the purpose of these files?
 
## Lab 1-2:

### Question 1: Upload the Lab01-02.exe file to VirusTotal. Does it match any existing antivirus definitions? 

### Question 2: Are there any indications that this file is packed or obfuscated? If so, what are these indicators? If the file is packed, unpack it if possible.

### Question 3: Do any imports hint at this program’s functionality? If so, which imports are they and what do they tell you?

### Question 4: What host- or network-based indicators could be used to identify this malware on infected machines?

## Lab 1-3:

### Question 1: Upload the Lab01-03.exe file to VirusTotal. Does it match any existing antivirus definitions? 

### Question 2: Are there any indications that this file is packed or obfuscated? If so, what are these indicators? If the file is packed, unpack it if possible.

### Question 3: Do any imports hint at this program’s functionality? If so, which imports are they and what do they tell you?

### Question 4: What host- or network-based indicators could be used to identify this malware on infected machines?

## Lab 1-4:

### Question 1:
